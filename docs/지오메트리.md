# 컴퓨터 그래픽스: 지오메트리

컴퓨터 그래픽스에서 3D 객체를 2D 화면에 표시하기까지의 과정은 여러 단계의 기하학적 변환(Geometry Transformation)으로 이루어집니다. 이 전체 과정을 **변환 파이프라인(Transformation Pipeline)**이라고 부릅니다.

---

## 1. 기본 변환 (Basic Transformations)

3D 모델을 움직이고, 회전하고, 크기를 조절하는 가장 기본적인 변환입니다.

*   **이동 (Translation):** 객체의 위치를 특정 방향으로 옮깁니다.
*   **회전 (Rotation):12**: 객체를 특정 축을 기준으로 회전시킵니다.
*   **크기 조절 (Scaling):** 객체의 크기를 늘리거나 줄입니다.

이러한 변환들은 행렬 연산을 통해 이루어지는데, 이동 변환은 덧셈, 회전과 크기 조절은 곱셈으로 표현됩니다. 연산 방식이 달라 복잡하기 때문에 **동차좌표계(Homogeneous Coordinates)**를 도입하여 모든 변환을 행렬 곱셈으로 통일합니다.

---

## 2. 동차좌표계 (Homogeneous Coordinates)

동차좌표계는 3D 좌표(x, y, z)에 w라는 네 번째 차원을 추가하여 (x, y, z, w) 형태로 표현하는 방식입니다. 보통 3D 공간의 점은 w=1로, 방향을 나타내는 벡터는 w=0으로 설정합니다.

### 동차좌표계를 사용하는 이유

1.  **변환의 통일**: 이동, 회전, 크기 조절 등 모든 변환을 4x4 행렬의 곱셈 하나로 표현할 수 있습니다. 이를 통해 복잡한 변환 순서를 간단하게 처리하고, 여러 변환을 미리 계산하여 하나의 행렬로 만들어 효율을 높일 수 있습니다.
2.  **원근 투영 표현**: 원근법에서 가까운 물체는 크게, 먼 물체는 작게 보이는 효과를 행렬 곱셈으로 자연스럽게 구현할 수 있습니다. w 값을 조절하여 원근감을 표현합니다. (가까운 물체는 작게, 먼 물체는 크게 변경한다는 내용은 원근 투영의 원리와 반대입니다. 원근 투영에서는 가까울수록 크게 보입니다.)
3.  **소실점(Vanishing Point) 표현**: 무한히 먼 점(소실점)을 w=0으로 설정하여 수학적으로 명확하게 다룰 수 있습니다.

---

## 3. 변환 파이프라인 (Transformation Pipeline)

3D 모델 데이터(정점)가 화면에 그려지기까지 거치는 변환 과정입니다.

`로컬 공간 -> 월드 공간 -> 뷰(카메라) 공간 -> 클립 공간 -> NDC -> 화면 공간`

### 1) 모델 변환 (Model Transformation)

*   **로컬 공간(Local Space)**에 있는 모델을 **월드 공간(World Space)**으로 배치하는 과정입니다.
*   각 객체는 자신만의 좌표계(로컬 공간)를 가집니다. 이 객체들을 월드 공간이라는 하나의 공통된 공간에 배치하기 위해 이동, 회전, 크기 조절을 적용합니다.

### 2) 관측 변환 (Viewing Transformation)

*   월드 공간의 객체들을 **뷰(카메라) 공간(View Space)**으로 변환합니다.
*   카메라의 위치와 방향을 기준으로 월드 전체를 재배치하는 것과 같습니다. 즉, 카메라가 원점(0,0,0)에 위치하고 -Z축을 바라보도록 월드 공간의 모든 객체를 함께 움직이는 변환입니다.

### 3) 모델뷰 변환 (Model-View Transformation)

*   **모델 변환**과 **관측 변환**은 종종 합쳐져 **모델뷰 행렬(Model-View Matrix)**이라는 하나의 행렬로 만들어집니다.
*   **모델뷰의 이중성**: 모델뷰 변환은 두 가지 관점으로 해석될 수 있습니다.
    1.  **모델링 변환 + 관측 변환**: 객체를 월드 공간에 배치하고(모델링), 이 월드를 카메라 시점으로 가져온다(관측).
    2.  **고정된 카메라와 움직이는 객체**: 카메라를 원점에 고정시키고, 객체를 카메라 앞으로 가져와 특정 위치에 배치하는 것으로 해석할 수도 있습니다.
*   결과적으로는 동일하며, 두 변환을 합쳐서 연산하면 효율적입니다.

### 4) 투영 변환 (Projection Transformation)

*   뷰 공간에 있는 3D 모델을 2D로 표현하기 위해 **클립 공간(Clip Space)**으로 변환하는 과정입니다. 카메라의 **절두체(Frustum)** 내에 보이는 영역을 정규화된 공간으로 찌그러뜨립니다.
*   **원근 투영 (Perspective Projection)**: 가까운 물체는 크게, 먼 물체는 작게 보이게 하여 원근감을 줍니다. 일반적인 3D 게임이나 시뮬레이션에서 사용됩니다.
*   **직교 투영 (Orthographic Projection)**: 거리에 상관없이 모든 물체를 같은 크기로 표현합니다. 건축 도면이나 CAD, 일부 2D 스타일 게임에서 사용됩니다.

### 5) 뷰포트 변환 (Viewport Transformation)

*   투영 변환을 거친 **클립 공간**의 좌표는 보통 **-1에서 1 사이의 정규화된 장치 좌표(Normalized Device Coordinates, NDC)**로 변환됩니다.
*   이 NDC 좌표를 실제 화면(윈도우)의 특정 영역, 즉 **뷰포트(Viewport)**의 픽셀 좌표로 최종 변환합니다.
*   일반적으로는 NDC와 뷰포트가 1:1로 대응되지만, 화면 분할(Split Screen)과 같이 하나의 화면에 여러 뷰를 보여줄 때는 특정 영역에만 렌더링하도록 뷰포트 설정을 변경할 수 있습니다.

---

## 4. 추가 개념

### 버텍스(Vertex)와 포인트(Point)의 차이

*   **포인트(Point)**: 단순히 공간상의 한 위치(좌표)를 의미합니다.
*   **버텍스(Vertex)**: 그래픽스에서 사용되는 더 구체적인 개념으로, 위치 정보(좌표)뿐만 아니라 **색상(Color), 법선 벡터(Normal Vector), 텍스처 좌표(Texture Coordinates)** 등 렌더링에 필요한 추가 데이터를 포함하는 '정점'을 의미합니다. 폴리곤(Polygon)과 같은 기하학적 도형을 구성하는 기본 단위입니다.

### 안티에일리어싱 (Anti-aliasing)

*   디지털 화면은 픽셀이라는 사각형 격자로 이루어져 있어 직선이나 곡선을 표현할 때 계단 현상(**에일리어싱, Aliasing**)이 발생합니다.
*   **안티에일리어싱**은 이 계단 현상을 완화하는 기술입니다. 경계선 주변의 픽셀 색상을 배경색과 물체색의 중간 값으로 채워 경계를 부드럽게 보이게 만듭니다.

### 행렬 스택 (Matrix Stack): Push와 Pop

복잡한 장면을 렌더링할 때, 여러 객체가 계층적으로 변환되거나(예: 태양계 모델에서 행성이 태양 주위를 돌고, 위성이 행성 주위를 도는 경우), 특정 변환 상태를 임시로 저장하고 복원해야 할 때가 있습니다. 이때 **행렬 스택(Matrix Stack)**이 유용하게 사용됩니다.

*   **Push:** 현재 변환 행렬(예: 모델뷰 행렬)을 스택의 상단에 저장합니다. 이를 통해 현재의 변환 상태를 '백업'해 둘 수 있습니다.
*   **Pop:** 스택의 가장 상단에 저장된 행렬을 가져와 현재 변환 행렬로 설정합니다. 이를 통해 이전에 저장했던 변환 상태로 '복원'할 수 있습니다.

**사용 예시:**
부모 객체를 렌더링한 후 자식 객체를 렌더링할 때, 부모의 변환 행렬을 Push 해둔 뒤 자식 객체에 대한 변환을 적용하고, 자식 객체 렌더링이 끝나면 Pop 하여 다시 부모의 변환 상태로 돌아올 수 있습니다. 이는 장면 그래프(Scene Graph)와 같은 계층적 모델링에서 특히 유용합니다.

---

## 5. 애니메이션과 시간 처리: glutTimerFunc

`glutTimerFunc`는 GLUT 라이브러리에서 제공하는 함수로, 지정된 시간이 지난 후에 특정 함수를 한 번 호출하도록 예약하는 역할을 합니다. 이를 이용해 애니메이션이나 주기적인 업데이트를 구현할 수 있습니다.

### 함수 원형

```c
void glutTimerFunc(unsigned int msecs, void (*func)(int value), int value);
```

*   `msecs`: 밀리초(ms) 단위의 시간. 이 시간이 지나면 `func` 함수가 호출됩니다. (1000ms = 1초)
*   `func`: 지정된 시간이 지난 후 호출될 콜백 함수. 이 함수는 정수형 인자 하나를 받습니다.
*   `value`: 콜백 함수 `func`에 전달될 정수 값. 여러 타이머를 구분하거나 특정 데이터를 전달하는 데 사용할 수 있습니다.

